EMU8086 GENERATED LISTING. MACHINE CODE <- SOURCE.
 
again.com -- emu8086 assembler version: 4.05  
 
[ 15.12.2024  --  23:20:46 ] 
 
===================================================================================================
[LINE]     LOC: MACHINE CODE                          SOURCE
===================================================================================================
 
[   1]        :                                       .model tiny
[   2]    0100:                                       .code
[   3]        :                                       org 100h
[   4]        :                                       
[   5]    0100:                                       start:
[   6]    0100: E8 61 00                              call read_commandline
[   7]    0103: BC DE 04                              mov sp, program_length + 100h + 200h
[   8]        :                                       
[   9]        :                                       ; Устанавливаем начальные значения для EPB
[  10]    0106: 8C C8                                 mov ax, cs
[  11]    0108: A3 D0 02                              mov word ptr EPB + 4, ax
[  12]    010B: A3 D4 02                              mov word ptr EPB + 8, ax
[  13]    010E: A3 D8 02                              mov word ptr EPB + 0Ch, ax
[  14]        :                                       
[  15]        :                                       ; Начинаем цикл считывания и запуска программ
[  16]    0111: BE 86 01                              lea si, filename
[  17]    0114:                                       next_program:
[  18]        :                                       ; Открываем файл
[  19]    0114: B8 01 3D                              mov ax, 3D01h         ; Открытие файла для чтения
[  20]    0117: BA 86 01                              lea dx, filename
[  21]    011A: CD 21                                 int 21h
[  22]    011C: 8B D8                                 mov bx, ax            ; Дескриптор файла
[  23]    011E: 72 29                                 jc open_error
[  24]        :                                       
[  25]        :                                       ; Считываем имя программы
[  26]    0120: B4 3F                                 mov ah, 3Fh          ; Чтение из файла
[  27]    0122: BA EA 01                              lea dx, program_path  ; Путь к программе
[  28]    0125: B9 64 00                              mov cx, 100          ; Читаем до 100 байт
[  29]    0128: CD 21                                 int 21h
[  30]    012A: 72 26                                 jc read_error
[  31]        :                                       
[  32]        :                                       ; Проверяем, считали ли строку
[  33]    012C: 3D 00 00                              cmp ax, 0
[  34]    012F: 74 0F                                 je no_more_programs   ; Если ничего не считали, выходим
[  35]        :                                       
[  36]        :                                       ; Запускаем программу
[  37]    0131: B8 00 4B                              mov ax, 4B00h
[  38]    0134: BA EA 01                              mov dx, offset program_path
[  39]    0137: BB CC 02                              mov bx, offset EPB
[  40]    013A: CD 21                                 int 21h
[  41]    013C: 72 1D                                 jc run_error
[  42]        :                                       
[  43]        :                                       ; Переходим к следующему имени программы
[  44]    013E: EB D4                                 jmp next_program
[  45]        :                                       
[  46]    0140:                                       no_more_programs:
[  47]        :                                       ; Закрываем файл, если был открыт
[  48]    0140: B4 3E                                 mov ah, 3Eh
[  49]    0142: CD 21                                 int 21h
[  50]        :                                       
[  51]    0144:                                       exit:
[  52]    0144: B8 00 4C                              mov ax, 4C00h
[  53]    0147: CD 21                                 int 21h
[  54]        :                                       
[  55]    0149:                                       open_error:
[  56]    0149: BA 4E 02                              mov dx, offset open_error_msg
[  57]    014C: B4 09                                 mov ah, 09h
[  58]    014E: CD 21                                 int 21h
[  59]    0150: EB F2                                 jmp exit
[  60]        :                                       
[  61]    0152:                                       read_error:
[  62]    0152: BA 78 02                              mov dx, offset read_error_msg
[  63]    0155: B4 09                                 mov ah, 09h
[  64]    0157: CD 21                                 int 21h
[  65]    0159: EB E9                                 jmp exit
[  66]        :                                       
[  67]    015B:                                       run_error:
[  68]    015B: BA A0 02                              mov dx, offset run_error_msg
[  69]    015E: B4 09                                 mov ah, 09h
[  70]    0160: CD 21                                 int 21h
[  71]    0162: EB E0                                 jmp exit
[  72]        :                                       
[  73]    0164:                                       proc read_commandline
[  74]    0164: BE 80 00                              mov si, 80h
[  75]    0167: 33 C9                                 xor cx, cx
[  76]    0169: 26 8A 0C                              mov cl, es:[si]
[  77]    016C: 83 C6 02                              add si, 2
[  78]    016F: BF 86 01                              lea di, filename
[  79]    0172:                                       read_loop:
[  80]    0172: 26 8A 04                              mov al, es:[si]
[  81]    0175: 3C 0D                                 cmp al, 0Dh
[  82]    0177: 75 08                                 jne write_symbol
[  83]    0179: B0 00                                 mov al, 0
[  84]    017B: AA                                    stosb
[  85]    017C: 46                                    inc si
[  86]    017D: E2 F3                                 loop read_loop
[  87]    017F: EB 04                                 jmp end_read
[  88]    0181:                                       write_symbol:
[  89]    0181: AA                                    stosb
[  90]    0182: 46                                    inc si
[  91]    0183: E2 ED                                 loop read_loop
[  92]    0185:                                       end_read:
[  93]    0185: C3                                    ret
[  94]        :                                       endp
[  95]        :                                       
[  96]    0186: 00 00 00 00 00 00 00 00 00 00 00 00   filename db 100 dup(0)     ; Массив для хранения имен программ
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00                         
[  97]    01EA: 00 00 00 00 00 00 00 00 00 00 00 00   program_path db 100 dup(0) ; Путь к программе
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00                         
[  98]    024E: 45 72 72 6F 72 3A 20 43 6F 75 6C 64   open_error_msg db 'Error: Could not open the specified file.$'
                20 6E 6F 74 20 6F 70 65 6E 20 74 68 
                65 20 73 70 65 63 69 66 69 65 64 20 
                66 69 6C 65 2E 24                   
[  99]    0278: 45 72 72 6F 72 3A 20 43 6F 75 6C 64   read_error_msg db 'Error: Could not read the program name.$'
                20 6E 6F 74 20 72 65 61 64 20 74 68 
                65 20 70 72 6F 67 72 61 6D 20 6E 61 
                6D 65 2E 24                         
[ 100]    02A0: 45 72 72 6F 72 3A 20 43 6F 75 6C 64   run_error_msg db 'Error: Could not run the specified program.$'
                20 6E 6F 74 20 72 75 6E 20 74 68 65 
                20 73 70 65 63 69 66 69 65 64 20 70 
                72 6F 67 72 61 6D 2E 24             
[ 101]        :                                       
[ 102]    02CC: 00 00                                 EPB dw 0000
[ 103]    02CE: DA 02 00 00                           dw offset commandline, 0
[ 104]    02D2: 5C 00 00 00 6C 00 00 00               dw 005Ch, 0, 006Ch, 0
[ 105]    02DA: 7D                                    commandline db 125
[ 106]    02DB: 20 2F 3F                              db " /?"
[ 107]    02DE:                                       program_length equ $ - start
[ 108]        :                                       end start
[ 109]        :                                       
 
===================================================================================================
 




===================================================================================================
